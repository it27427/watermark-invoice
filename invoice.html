<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- REQUIRED-META-TAGS -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- PAGE-TITLE -->
    <title>Invoice</title>

    <!-- FAVICON-ICON -->
    <link
      rel="shortcut icon"
      href="assets/images/favicon.ico"
      type="image/x-icon"
    />

    <!-- FONT-AWESOME-CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    />

    <!-- GOOGLE-FONT-CDN -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- TAILWIND-CSS-CDN -->
    <script src="assets/js/tailwindcss.js" defer></script>

    <!-- INVOICE-STYLES-START -->
    <style>
      :root {
        --theme: #002147;
        --white: #fff;
        --body-bg: #f7f7f7;
        --border-color: #d1d5db;
      }

      * {
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", sans-serif;
        background-color: var(--body-bg);
        margin: 0;
        padding: 0;
      }

      .logo {
        width: 15.8125rem;
        height: 4.6875rem;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .invoice {
        width: 210mm;
        min-height: 297mm;
        box-shadow: none;
        border-radius: 0;
        display: flex;
        flex-direction: column;
        background-color: var(--white);
        margin: 0 auto;
        position: relative;
        z-index: 1;
        page-break-after: avoid;
        page-break-inside: avoid;
      }

      .invoice-watermark {
        position: relative;
        overflow: hidden;
      }

      .invoice-watermark::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url("assets/images/brand.png");
        background-repeat: no-repeat;
        background-position: center center;
        background-size: 50%;
        opacity: 0.15;
        pointer-events: none;
        z-index: 0;
      }

      .invoice-content {
        flex: 1;
        position: relative;
        z-index: 10;
        padding: 1.5rem 1.5rem 0;
        display: flex;
        flex-direction: column;
      }

      .title {
        padding-bottom: 0.5rem;
      }

      .headerborder {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.75rem;
        width: 100%;
        position: relative;
        z-index: 20;
      }

      .headerborder span {
        height: 0.25rem;
      }

      .footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 0.75rem;
        padding: 0.75rem 1.5rem 2.5rem;
        border-top: 0.0625rem solid var(--border-color);
        margin-top: auto;
        flex-wrap: nowrap;
        gap: 0.5rem;
      }

      .footer-left,
      .footer-center,
      .footer-right {
        flex: 1;
        min-width: 0;
        height: 2.75rem;
      }

      .footer-left {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .footer-left .icon,
      .footer-right .icon {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: -0.35rem;
        margin-right: -0.125rem;
      }

      .footer .footer-left .footborder {
        margin-left: -0.125rem;
      }

      .footer-center {
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }

      .footer-right {
        display: flex;
        align-items: flex-start;
        gap: 0.5rem;
        justify-content: flex-end;
      }

      .footer-address {
        font-size: 0.75rem;
        line-height: 1.2;
      }

      .signature {
        margin-top: 3rem;
        margin-inline-start: auto;
        display: flex;
        justify-content: flex-end;
        gap: 2rem;
      }

      .signature div {
        text-align: center;
      }

      .table-container {
        width: 100%;
        overflow: hidden;
        margin-bottom: 2rem;
      }

      .tablepadding {
        padding: 0.75rem 1rem 1.5rem;
      }

      tr,
      th,
      td {
        vertical-align: middle;
      }

      .tableitems {
        margin-top: -15rem;
      }

      @media print {
        body {
          margin: 0;
          padding: 0;
          background: var(--white);
          width: 210mm;
          height: 297mm;
        }

        .invoice {
          box-shadow: none;
          border-radius: 0;
          width: 210mm;
          min-height: 297mm;
          margin: 0;
          page-break-after: avoid;
          page-break-inside: avoid;
        }

        .no-print {
          display: none !important;
        }

        .invoice-content {
          padding: 1.5rem 1.5rem 0;
        }

        table {
          page-break-inside: auto;
        }

        tr {
          page-break-inside: avoid;
          page-break-after: auto;
        }

        tbody {
          page-break-inside: avoid;
        }

        .footer {
          position: relative;
          bottom: 0;
          width: 100%;
          padding-bottom: 0.75rem;
          page-break-after: avoid;
        }

        .footer .footer-left .footborder {
          margin: 0;
          page-break-after: avoid;
        }

        .footer-left .icon,
        .footer-right .icon {
          margin: 0;
          page-break-after: avoid;
        }

        .footer-left .icon:first-child {
          margin-right: -0.25rem;
        }

        .title {
          padding-bottom: 0.125rem;
          page-break-after: avoid;
        }

        .tablepadding {
          padding: 0.75rem 1rem;
          page-break-after: avoid;
        }
      }
    </style>
    <!-- INVOICE-STYLES-END -->
  </head>
  <body>
    <div class="invoice invoice-watermark">
      <!-- INVOICE-HEADER -->
      <header class="text-black p-6 header">
        <nav class="flex items-center justify-between">
          <figure class="logo">
            <img
              src="assets/images/logo.png"
              alt="Company-Logo"
              class="w-full h-full object-cover"
              onerror="this.onerror=null; this.src='assets/images/logo.png';"
            />
          </figure>

          <ul class="flex items-end gap-3 text-right">
            <li class="inline-flex items-start gap-2">
              <i class="fa-solid fa-envelope text-blue-500 text-lg"></i>

              <span
                class="text-black font-medium text-sm inline-flex flex-col gap-0.5"
              >
                <span class="block">info@wmabd.com</span>
                <span class="block">info@wmabd.com</span>
              </span>
            </li>

            <li class="inline-flex items-start gap-2">
              <i class="fa-solid fa-phone text-blue-500 text-lg"></i>

              <span
                class="text-black font-medium text-sm inline-flex flex-col gap-0.5"
              >
                <span class="block">+880 1713428975</span>
                <span class="block">+880 1713428976</span>
              </span>
            </li>
          </ul>
        </nav>
      </header>

      <!-- HEADER-BOTTOM-BORDER -->
      <div class="headerborder">
        <span
          class="flex-[1] bg-[#ef4444] rounded-full transform skew-x-12"
        ></span>
        <span
          class="flex-[1] bg-blue-900 rounded-full transform -skew-x-12"
        ></span>

        <!-- Center border auto-grow -->
        <span
          class="flex-[2] bg-[#1877F2] rounded-full transform skew-x-12"
        ></span>

        <span
          class="flex-[1] bg-[#10b981] rounded-full transform -skew-x-12"
        ></span>
        <span
          class="flex-[1] bg-[#f59e0b] rounded-full transform skew-x-12"
        ></span>
      </div>

      <main class="invoice-content">
        <!-- CUSTOMER-BILLING-INFO -->
        <div class="w-full mt-5 mb-10">
          <p class="text-sm text-black font-medium">Date: 13 November, 2025</p>
          <p class="text-sm text-black">General Manager,</p>
          <p class="text-sm text-black">Chittagong Flour Mills</p>
          <p class="text-sm text-black">5/6 Nasirabad I/A</p>
          <p class="text-sm text-black">Nasirabad, Chattogram</p>
        </div>

        <!-- ITEM-TABLE -->
        <div
          class="flex flex-col items-center justify-center flex-1 tableitems"
        >
          <h4
            class="text-center uppercase mb-4 text-black font-bold border-b-2 border-black inline-block text-xl title"
          >
            CHALLAN
          </h4>

          <div class="table-container">
            <table class="min-w-full border border-gray-600 border-collapse">
              <thead>
                <tr>
                  <th
                    class="border border-gray-600 tablepadding text-center text-xs font-semibold text-black uppercase"
                  >
                    SL
                  </th>
                  <th
                    class="border border-gray-600 tablepadding text-center text-xs font-semibold text-black uppercase"
                  >
                    Description
                  </th>
                  <th
                    class="border border-gray-600 tablepadding text-center text-xs font-semibold text-black uppercase"
                  >
                    Quantity
                  </th>
                  <th
                    class="border border-gray-600 tablepadding text-center text-xs font-semibold text-black uppercase"
                  >
                    Rate
                  </th>
                  <th
                    class="border border-gray-600 tablepadding text-center text-xs font-semibold text-black uppercase"
                  >
                    Amount
                  </th>
                </tr>
              </thead>

              <tbody>
                <tr>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm font-semibold text-black"
                  >
                    1
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    S.S Conveyer Blade
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    154
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    ‡ß≥100.00
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm font-semibold text-black"
                  >
                    ‡ß≥15,400.00
                  </td>
                </tr>

                <tr>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm font-semibold text-black"
                  >
                    2
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    S.S Nut
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    45
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm text-black"
                  >
                    ‡ß≥110.00
                  </td>
                  <td
                    class="border border-gray-600 tablepadding text-center text-sm font-semibold text-black"
                  >
                    ‡ß≥4,950.00
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Signature -->
          <div class="signature">
            <div>
              <p>__________________________</p>
              <p>Authorized Signature</p>
            </div>
          </div>
        </div>
      </main>

      <!-- FOOTER -->
      <footer class="footer">
        <div class="footer-left">
          <span class="icon">
            <i class="fa-brands fa-square-facebook text-[#1877F2] text-2xl"></i>
          </span>

          <span
            class="inline-block w-[0.0625rem] h-[2rem] bg-gray-300 mt-3 footborder"
          ></span>

          <div class="flex-col">
            <span class="text-gray-700">Follow us</span>
            <p class="text-[#1877F2] font-semibold">Western Maritime Academy</p>
          </div>
        </div>

        <div class="footer-center">
          <p class="font-semibold text-black">www.wmabd.com</p>
        </div>

        <div class="footer-right">
          <span class="icon">
            <i class="fa-solid fa-location-dot text-2xl text-blue-700"></i>
          </span>
          <span class="footer-address text-gray-700">
            Vhorar Ghat Bazar, Fotepur, Palichora Road Rangpur Sador,
            Rangpur-5400. Bangladesh
          </span>
        </div>
      </footer>
    </div>

    <!-- PRINT-DOWNLOAD-BUTTONS -->
    <div class="flex justify-center gap-4 mt-6 no-print">
      <button
        onclick="window.print()"
        class="bg-blue-600 text-white px-4 py-2 rounded"
      >
        üñ®Ô∏è Print
      </button>
      <button
        onclick="downloadPDF()"
        class="bg-green-600 text-white px-4 py-2 rounded"
      >
        üíæ Download PDF
      </button>
    </div>

    <!-- HTML2CANVAS-CDN -->
    <script src="assets/js/html2canvas.min.js"></script>
    <!-- JSPDF -->
    <script src="assets/js/jspdf.umd.min.js"></script>
    <script>
      async function downloadPDF() {
        const { jsPDF } = window.jspdf;
        const invoice = document.querySelector(".invoice");

        if (!invoice) {
          console.error("Invoice element not found!");
          return;
        }

        // Hide no-print elements during PDF generation
        const noPrintElements = document.querySelectorAll(".no-print");
        noPrintElements.forEach((el) => (el.style.display = "none"));

        try {
          // Capture invoice as canvas with exact dimensions
          const canvas = await html2canvas(invoice, {
            scale: 2,
            useCORS: true,
            logging: false,
            backgroundColor: "#ffffff",
            width: 794, // A4 width in pixels at 96 DPI (210mm ‚âà 794px)
            height: 1123, // A4 height in pixels at 96 DPI (297mm ‚âà 1123px)
            windowWidth: 794,
            windowHeight: 1123,
          });

          // Restore no-print elements
          noPrintElements.forEach((el) => (el.style.display = ""));

          const imgData = canvas.toDataURL("image/png");
          const pdf = new jsPDF("p", "mm", "a4");
          const pdfWidth = pdf.internal.pageSize.getWidth();
          const pdfHeight = pdf.internal.pageSize.getHeight();

          // Add image to PDF - fit to page
          pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight, null, "FAST");

          // Save PDF
          pdf.save("invoice.pdf");
        } catch (err) {
          console.error("PDF generation failed:", err);
          // Restore no-print elements in case of error
          noPrintElements.forEach((el) => (el.style.display = ""));
        }
      }
    </script>
  </body>
</html>
